# VLM Configuration
# Two-endpoint setup for work-stealing queue

# =============================================================================
# ENDPOINTS
# =============================================================================
endpoints:
  localhost:
    url: http://localhost:11434
    max_concurrent: 1
    timeout_seconds: 900
    retry_attempts: 3
    retry_delay_seconds: 1.0

  remote:
    url: http://100.125.221.105:11434
    max_concurrent: 1
    timeout_seconds: 900
    retry_attempts: 3
    retry_delay_seconds: 1.0

# =============================================================================
# MODELS
# =============================================================================
# Multi-endpoint configuration:
# - localhost: all models (small, medium, large)
# - remote: only small and medium models
models:
  qwen3-vl:4b:
    endpoints: [localhost]  # Available on both
    tier: small
    context_window: 32768

  qwen3-vl:8b:
    endpoints: [localhost]  # Available on both
    tier: medium
    context_window: 32768

  qwen3-vl:30b:
    endpoints: [localhost]          # Only on localhost
    tier: large
    context_window: 32768

# =============================================================================
# MODEL TIERS
# =============================================================================
model_tiers:
  small: qwen3-vl:4b
  medium: qwen3-vl:8b
  large: qwen3-vl:30b

# =============================================================================
# KEY-TO-TIER MAPPINGS
# =============================================================================
# Maps classification keys to model tiers: small (4B), medium (8B), large (30B)

key_mapping:
  # Stage 1: Scene reasoning (always large - needs image understanding)
  stage1: large

  # --- Scene Context ---
  weather: small
  time_of_day: small
  road_type: small
  traffic_situation: medium

  # --- Object Detection ---
  pedestrians_present: small
  cyclists_present: small
  construction_activity: small
  traffic_signals_visible: medium
  vehicle_count: medium
  notable_elements: medium

  # --- Spatial Reasoning (complex 3D/relational reasoning = large) ---
  occlusion_level: medium
  depth_complexity: large
  nearest_vehicle_distance: medium  # estimation from description
  spatial_relations: large

  # --- Perceptual Challenges ---
  visual_degradation: medium
  similar_object_confusion: large   # needs reasoning about what could be confused
  edge_case_objects: medium         # classification with context

  # --- Safety Critical (reasoning about risk = large) ---
  safety_criticality: large
  vulnerable_road_users: large      # safety-critical, must not miss anyone
  immediate_hazards: large
  required_action: large            # decision reasoning

  # --- Counting & Quantification (extraction from stage1 = medium) ---
  pedestrian_count: medium
  vehicle_count_by_type: medium

  # --- Attribute Binding (extraction/classification = medium) ---
  traffic_light_states: medium
  lane_marking_type: medium
